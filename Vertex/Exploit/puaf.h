//
//  puaf.h
//  Apex
//
//  Created by Alfie on 27/08/2024.
//

#ifndef puaf_h
#define puaf_h

#include <stdio.h>
#include <stdint.h>
#include <stdbool.h>

#define pages(num) ((num) * (vm_kernel_page_size))

#define VMNE_SIZE (pages(2) + 1)
#define VME_SIZE (pages(2))
#define VME_OFFSET (pages(1))

void physpuppet_run(int nPages, uint64_t puafPages[]);
void physpuppet_deinit(int nPages, uint64_t puafPages[], uint64_t puafPage);

void copy_init(void);
void copy_deinit(void);
bool puaf_check_free_pages(int nPages, uint64_t puafPages[]);

#endif /* puaf_h */
