//
//  krw.h
//  Vertex
//
//  Created by Alfie on 24/09/2024.
//

#ifndef krw_h
#define krw_h

#include <stdio.h>
#include <stdint.h>

extern uint64_t gTask;
extern uint64_t gProc;
extern uint64_t gUcred;

struct KernelPrimitives {
    void (*kreadbuf)(uint64_t, void *, uint64_t);
    uint8_t (*kread8)(uint64_t);
    uint16_t (*kread16)(uint64_t);
    uint32_t (*kread32)(uint64_t);
    uint64_t (*kread64)(uint64_t);
    
    void (*kwritebuf)(uint64_t, void *, uint64_t);
    void (*kwrite8)(uint64_t, uint8_t);
    void (*kwrite16)(uint64_t, uint16_t);
    void (*kwrite32)(uint64_t, uint32_t);
    void (*kwrite64)(uint64_t, uint64_t);
};

extern struct KernelPrimitives gPrimitives;

uint8_t kread8(uint64_t va);
uint16_t kread16(uint64_t va);
uint32_t kread32(uint64_t va);
uint64_t kread64(uint64_t va);
void kreadbuf(uint64_t va, void *buf, size_t len);

void kwrite8(uint64_t va, uint8_t val);
void kwrite16(uint64_t va, uint16_t val);
void kwrite32(uint64_t va, uint32_t val);
void kwrite64(uint64_t va, uint64_t val);
void kwritebuf(uint64_t va, void *buf, size_t len);


#endif /* krw_h */
